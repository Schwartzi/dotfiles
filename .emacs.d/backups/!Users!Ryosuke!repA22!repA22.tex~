\documentclass{icsreport}
\usepackage[dvips]{graphicx}
% \usepackage{slashbox}


\title{\sf{\Huge{情報科学実験A後期\\最終レポート}}} % 題目
\author{谷村亮介}                      % 提出者名
\date{平成25年1月31日}                  % 提出日

\課題名{非同期通信回路の設計}               % 課題名
\担当教官{大下裕一、置田真生}                       % 担当教官名
\所属{ソフトウェア科学コース}             % 自分の所属するコース名などを指定する. 
\学年{2年}                             % 学年
\学籍番号{09B11044}                    % 学籍番号
% 班やグループ名.
% 必要なければ指定しなくてもよい. 
\email{u549298j@ecs.osaka-u.ac.jp}    % 電子メールのアドレス

\begin{document}
\maketitle

\section{課題34}

\subsection{課題内容}

上記で決めた手順において，システム  1  のクロックとシステム  2  のクロックの
周期がほぼ等しい場合における，各信号線（RESET, NEXT, SEND, RECEIVE）とデータ
線上の信号のタイミングチャートを作成せよ

\subsection{解答}

作成したタイミングチャートを図\ref{fig:c1}に示す。

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=7.0cm]{c1.eps}
    \caption{クロック周期がほぼ等しい場合のタイミングチャート}
    \label{fig:c1}
  \end{center}
\end{figure}



\section{課題35}

\subsection{課題内容}

システム 1 のクロックがシステム 2 のクロックに比べて著しく速い場合、 お
よび著しく遅い場合の各場合における、 各信号線とデータ線のタイミングチャー
トを作成せよ。そのタイミングチャートにはシステム 1、 2 のクロック信号を明
記すること。

\subsection{解答}

システム 1 のクロックがシステム 2 のクロックに比べて著しく速い場合
のタイミングチャートを図\ref{fig:c2}に示す。

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=7.0cm]{./c2.eps}
    \caption{システム1のクロックが速い場合のタイミングチャート}
    \label{fig:c2}
  \end{center}
\end{figure}


システム 1 のクロックがシステム 2 のクロックに比べて著しく遅い場合
のタイミングチャートを図\ref{fig:c3}に示す。


\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=7.0cm]{./c3.eps}
    \caption{システム2のクロックが速い場合のタイミングチャート}
    \label{fig:c3}
  \end{center}
\end{figure}



\section{課題36}

\subsection{課題内容}

RESET信号、NEXT信号のON/OFFを考慮した状態遷移図を示せ。システム1と システム 2 両方を示
すこと。

\subsection{解答}

作成した状態遷移図を図\ref{fig:seni}に示す。

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=12.0cm]{./sysseni.eps}
    \caption{状態遷移図}
    \label{fig:seni}
  \end{center}
\end{figure}


\section{課題37}

\subsection{課題内容}

システム1 の各状態において各種信号線に設定すべき電位をまとめ、状態遷移図と
ともに示せ。

\subsection{解答}

システム1 の各状態において各種信号線に設定すべき電位をまとめ、
状態遷移図とともに示したものを図\ref{fig:seni1}に示す。

この図において、``S''はSEND信号を、
``L''はLOAD信号を、
``R''はREAD信号を示している。
また、``0''は、Loレベルを、
``1''は、Hiレベルを示す。

状態1では、待機中のため、
すべての信号を0にしておく。
状態2では、READ信号を1にして、
メモリのデータを読み出す。
状態3では、LOAD信号を1にして、
データをバスにのせ、SEND信号を1にする。
RECEIVE信号を受け取ったらSEND信号を0にして待機する。

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=12.0cm]{./sys1seni.eps}
    \caption{システム1の状態遷移図と各信号線}
    \label{fig:seni1}
  \end{center}
\end{figure}

\section{課題38}

\subsection{課題内容}

チャタリング現象についてまとめよ。

\subsection{解答}

チャタリング現象とは、
スイッチの接点が切り替わった際に、
非常に早い機械的振動が生じて電気信号が断続を繰り返す現象である。

身近な例としては、マウスの接点が劣化した際に、
シングルクリックをしたはずなのにダブルクリックが入力されてしまう、
などである。

今回の場合は、NEXTボタンのスイッチを押した際に、
連続してNEXT信号が入力されてしまうなどの現象が考えられる。


\section{課題39}

\subsection{課題内容}

チャタリング防止回路について、回路の例を示し動作原理をまとめよ。

\subsection{解答}

チャタリング防止回路は、
RSFFを用いて実現できる。
回路の例を図\ref{fig:no7}に示す。
スイッチがONの位置につながっている時、
ONはHiレベルに、OFFはLoレベルにセットされ、
QはHiレベルになる。
スイッチを離した時にチャタリングが発生するが、
OFFがHiレベルにならない限りQの出力は変化しないので、
チャタリングを防止することができる。

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=7.0cm]{no7.eps}
    \caption{チャタリング防止回路の例}
    \label{fig:no7}
  \end{center}
\end{figure}


\section{課題40}

\subsection{課題内容}

ブレッドボード上に作成した回路を撮影し、
どこに何を作成したのかを明示せよ。

\subsection{解答}

作成した回路を図\ref{fig:kairop}に示す。

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=12.0cm]{kairophoto.eps}
    \caption{作成した回路}
    \label{fig:kairop}
  \end{center}
\end{figure}

\section{課題41}

\subsection{課題内容}

表示回路の回路図を書き、動作原理を説明せよ。
どのピンと、どのピンが接続されているかが解かるように書くこと。

\subsection{解答}

%% 

\section{課題42}

\subsection{課題内容}

7447 は、オープンコレクタ出力である。
オープンコレクタについて等価回路
をもとに原理を述べ、 どのような回路に用いられるかを説明せよ。

\subsection{解答}

オープンコレクタの等価回路を図\ref{fig:open}に示す。

オープンコレクタ出力は、NPNトランジスタをスイッチとして動作させている。
トランジスタの状態がOFFのときは、
ICの出力は何も接続されていない状態となり、
外部のプルアップ抵抗と組み合わせることにより、出力はHiレベルになる。
トランジスタの状態がONのときは、
グラウンドに設置されて出力はLoレベルとなる。

オープンコレクタ出力は、プルアップ抵抗に接続する電圧を変化させることで、
出力電圧を変化させることができるので、
電圧の異なる回路同士を接続するときに用いられる。

また、電圧が0になる頻度が低い回路、
状態遷移時間がぶれても問題ない低速伝送回路に用いられている。
7447は7segLEDに出力するため、電圧が0になる頻度が少なく、
また、出力が高速である必要もないため、オープンコレクタ出力が用いられていると考えられる。


\begin{figure}[htbp]
  \begin{center}
    \includegraphics[clip,width=7.0cm]{open2.eps}
    \caption{オープンコレクタの例}
    \label{fig:open}
  \end{center}
\end{figure}

\section{課題43}

\subsection{課題内容}

7447の各出力値の真理値表から、
各出力abcdefgの論理を導き、
それぞれの最簡積和型を書け。

\subsection{解答}

それぞれの出力の最簡積和型を以下に示す。

\begin{math}
  a = \overline{D} \overline{C} B \vee 
  \overline{D} C A \vee
  D  \overline{B} A \vee
  \overline{C}  \overline{B}  \overline{A} \\
  b =  \overline{D}  \overline{C} \vee
  \overline{B}  \overline{A} \vee
  \overline{D} B A \vee
  D  \overline{C}  \overline{B}  \\
  c =  \overline{C}  \overline{B} \vee
  \overline{C} A \vee
  \overline{D} C  \\
  d = B \overline{A} \vee
  \overline{C} B \vee
  \overline{C} \overline{B} \overline{A} \vee
  C \overline{B} A  \\
  e = B \overline{A} \vee
  \overline{C}\overline{B}\overline{A} \\
  f = \overline{B}\overline{A} \vee
  C \overline{A} \vee
  C \overline{A}    \\
  g = B \overline{A} \vee
  C \overline{B} \vee
  D \overline{B} \vee
  \overline{C} B   \\
\end{math}

\section{課題44}

\subsection{課題内容}

ブレッドボード上の回路図を書け。FPGAボードとどのように連結しているかを含めて書くこと。
各ICのピンの接続がわかるように書くこと。
SN74シリーズ/74LSシリーズ/74HCシリーズを区別して書くこと。

\subsection{解答}

%% 

\section{課題45}

\subsection{課題内容}

74LSシリーズのICと74HCシリーズのICが混在する回路を作成する際に問題となる点をまとめよ。

\subsection{解答}

データシートを見ると、
74LSは、2.7V以上をHiレベルとして出力するのに対し、
74HCは3.5V以上の入力をHiレベルとして判断する。
従って、74LSの出力を74HCに接続した場合、
信号の伝達が正常に行われない場合がある。

\section{課題46}

\subsection{課題内容}

プルアップ抵抗及びプルダウン抵抗について、
用語をネットで調べ、その役割をまとめよ。
これにより上の課題で述べた問題点が解消される原理を説明せよ。

\subsection{解答}

デジタル回路の入力には、
常にHiレベルかLoレベルを入力していなければならず、
入力電圧がその中間になっている場合や、入力端子がどこにも接続されていない場合は、
誤動作を起こすことがある。

ここで、図\ref{fig:open}のように、
ある配線とVCCの間に抵抗を配置すると、
その配線がOFF状態の時にはHiレベルの電圧が出力され、
ON状態の時にはLoレベルが出力される。
この抵抗をプルアップ抵抗という。

プルダウン抵抗は配線とGNDの間に配置される抵抗で、
配線がOFF状態の時にLoレベルが出力される。

74LSの出力にプルアップ抵抗を用いると、
VCCに近い電圧が出力されるようになるため、
先ほどの問題が解消される。


\section{課題47}

\subsection{課題内容}

拡張した機能を含むシステムにかっこいい名前をつけよ。

\subsection{解答}

セレクタラブルハンドシェイカー

\section{課題48}

\subsection{課題内容}

グループメンバーの名前を記載せよ。
作業を分担した場合、誰がどこを担当したのか明記せよ。
\subsection{解答}

谷村\\
担当:メモリ、表示回路、バッファレジスタの作成。拡張機能その1。

小島\\
担当:RESET、NEXT信号の取り込み。送信終了LEDの作成。拡張機能その2。

\section{課題49}

\subsection{課題内容}

拡張の目的、適用例を記述せよ。

\subsection{解答}

今回の拡張機能は、
1.パリティビットを用いてデータ内容のエラーを検出して表示する機能。
2.システム2のメモリに格納されたデータを表示する際、
ディップスイッチではなくボタンで番地を指定する機能。
である。
以下に、それぞれの機能の目的、適用例を記述していく。

\paragraph{拡張その1}
\label{sec:1}
この機能の目的は、
データ転送中に何らかの問題が生じ、
システム1が送信したデータとシステム2が送信したデータの内容が違う際に、
それを発見できるようにすることである。

その適用例を述べていく。
まず、ブレッドボードから出力されたデータを、
システム1側のFPGAボードに取り込んで
パリティビットを計算し、システム2側のFPGAボードに送信する。
システム2側のFPGAボードでは、ブレッドボードから送信されてきたデータのバリティビットを計算し、
システム1から送信されたパリティビットと照合し、それが異なる場合は、
FPGAのLEDを光らせる。


\paragraph{拡張その2}
\label{sec:2}

この機能の目的は、
システム2のメモリに格納されたデータ内容をより確認しやすくすることである。

適用例としては、
FPGAボード上のボタン1を押すとメモリのアドレスに00を出力し、
ボタン2を押すと01を出力していくような、番地指定用のVHDLファイルを作成すれば良い。

\section{課題50}

\subsection{課題内容}

拡張の必要性、重要性をアピールせよ。
拡張した機能の斬新な点、独創的な点を述べよ。

\subsection{解答}
\paragraph{拡張その1}
デジタルデータは、1ピットでも間違ったデータを送信してしまうと、
そのデータ全体が破壊されてしまうことがある。
従って、データ転送の誤りを発見することができる機能はとても重要である。

パリティビットはxor回路を複数使用することで実現できるが、
ブレッドボード上でIC回路を用いて作成するのではなく、
あえてFPGAボード上で作成したのは斬新である。
また、誤りを検出した際の表示のために、
FPGAボードのLED5を使用したのは独創的であるといえる。

\paragraph{拡張その2}
メモリの番地をディップスイッチを用いて行うと、
小さなスイッチを何度も切り替えなければならず非常に面倒である。
それに対して、ボタンを用いれば切り替えを行いやすくなる。
メモリの内容の確認は実験中頻繁に行うため、
この作業を効率よく行うようにするのはとても重要である。

メモリの番地はディップスイッチを用いて行うものである、
という既成概念を打ち破ったこの機能は非常に斬新であり、
実現のために、あえてVHDLを使用したのは独創的である。


\section{課題51}

\subsection{課題内容}

拡張機能を実現することがいかに困難であるかをアピールせよ。

\subsection{解答}
\paragraph{拡張その1}
4ビットのデータのパリティビットを作成するためには、
xor回路を3つ接続する必要がある。
今回はこれをFPGAボード上で実現したが、
カルタスで上手く結線するのは事情に困難であった。
また、FPGAにデータを入力したりパリティビットを出力したりするための
入出力端子が不足してしまい、
それらを効率よく使用するのに苦労した。

\paragraph{拡張その2}
この機能を実現するために、今回はVHDLでハードウェアを記述した。
まだあまり扱いに慣れておらず、文法もやや難解なVHDL記述することは、
非常に困難であった。



\section{課題52}

\subsection{課題内容}

拡張した機能を含めた全体システムの動作仕様を書け。

\subsection{解答}

今回作成した拡張機能は、
実験資料P80に記述されている「システム仕様」の内容には影響しない。
従って、それに追加される動作仕様を以下に示す。


\noindent \rule{\textwidth}{0.1mm} 
\begin{tabbing}
  1234\=56789\kill
  \underline{送信されたデータに1ビットの誤りがあるとき}\\
  \> システム2のLED5を点灯する\\
  \underline{システム2のメモリがReadモードのとき}\\
  \> FPGAボードのボタン2段目でメモリの番地を指定する\\
\end{tabbing}
\noindent \rule{\textwidth}{0.1mm} 



\section{課題53}

\subsection{課題内容}

作成したシステムの構成図を書け。

\subsection{解答}


%% 

\section{課題54}

\subsection{課題内容}

拡張した機能に関して、システム1、システム2をどのように設計したのか
詳しく説明せよ。

\subsection{解答}

\paragraph{拡張その1}
この拡張機能を実現するためには、
まず、システム1とシステム2の両方でパリティビットを生成する必要がある。
パリティビットを生成するためには、送受信する4ビットのデータを、
$d_1 \bigoplus d_2 \bigoplus d_3 \bigoplus d_4$ としてやればよい。
この演算を実行するために、システム1、2両方にxor回路を多段接続した回路を作成した。
そして、ブレッドボードのバッファからの出力をシステム1に取り込んでパリティビットを生成し、
それをシステム2に送信する。
システム2がデータを受信したらパリティビットを生成し、
システム1から送られたパリティビットと比較する。
2つのパリティビットが異なっている場合にはLEDを点灯させる。

\paragraph{拡張その2}
この拡張機能は、システム2のFPGAボードの16個のボタンのうち4個のポタンを使用して、
1つ目のボタンを押すとメモリの番地指定端子に00を出力し、
2つ目のボタンを押すとメモリの番地指定端子に01を出力するような回路を作成すれば実現できる。
この回路は、VHDLを用いて作成した。
入力端子は4つ、出力端子は2つ設ける。
入力端子ののどれかがHiレベルになった時、
どのボタンが押されたのか判別し、
if分岐を用いて対応する2ビットの値を出力する。
ボタンが離された以降も出力する値を記憶しておくようにする。
出力端子はメモリの読み取り番地指定端子に接続しておく。
これにより、ボタンを用いた番地指定ができるようになる。

\section{課題55}

\subsection{課題内容}

グループで作業するにあたって工夫したことを述べよ。

\subsection{解答}
システム全体構成の把握の段階では、
手順書を読んだ内容を確認し合い、
課題内容をお互いが確実に理解している状態にした。
これにより、システム1の作成を2人で協力して進めることができた。

VHDLファイルを編集する際には、
誰がどのファイルを編集しているのか常に確認し、
どれが最新のものかわからなくなるような事態が起こることを防いだ。
しかし、PC間のデータのやり取りをUSBメモリを用いて行なっていたり、
「フォルダ名+編集日時」のフォルダがいくつも出来てしまっていたりした。
今後グループで開発を行う際には、Gitなどのバージョン管理システムの導入が有効であると考えられる。

手順7以降は作業を分担することにした。
その際、それぞれの作業の分量が同じくらいになるように分担するようにし、
分担作業中はお互いの進捗状況を頻繁に確認し合った。
これらのことに注意した結果、効率よく課題を進めることができた。

これから何をするのか、今日の実験ではどこまで進めるのか、
次回の実験での目標はなにか、などをよく確認することで、
2人の考えを共有しながらスムーズに課題を進めることができた。



\section{課題56}

\subsection{課題内容}

本実験を進めるにあたって調べた内容をまとめ、報告せよ。

\subsection{解答}

論理回路を作成するにあたって、
どのICを使用すれば良いか調べた。
その結果、
NOTゲートには7404を、
ANDゲートには7408を、
NANDゲートには7400を、
XORゲートには7486を用いれば良いことがわかった。

\section{課題57}

\subsection{課題内容}

本実験について、回路が正常に動かなかった原因とその解決方法。

\subsection{解答}

ブレッドボードボード上のメモリのアドレスやデータを指定する際に、
ディップスイッチを用いていたが、
ONにすると、VCCにつながり、
OFFにするとどこにも繋がっていない状態になっていたため、
回路が正常に動かなかった。
プルアップ抵抗を用いることで解決できた。

データをバスに載せる際に、
メモリの読み出しとバッファへのロードを同時に行なっていたため、
データが上手く取得できなかった。
メモリの読み出し遅延時間を考慮して、
バッファへのロードを少し送らせることで解決できた。

\section{課題58}

\subsection{課題内容}

本実験での反省。

\subsection{解答}

実験前には内容の予習を行なっていたため、
スムーズに実験を進めることができた。
その結果、比較的早い段階で実験を終えることができた。

問題が解決できずに長い時間を使ってしまった課題があった。
結果的に自己解決できたものの、TAに聞くなどしたほうがより効率が良かったかもしれない。

論理設計などの、他の授業で習ったことを生かしながら実験を進めることができた。



\section{課題59}

\subsection{課題内容}

本実験の感想。

\subsection{解答}

本実験では、新しく使用するソフトウェアや電子回路を多く使用したため、
戸惑いながらの作業が続いたが、
すべての課題をやり終えた後、もう一度手順書を見返してみると、
自分が非常に多くの事を習得できたことがわかった。
この実験は、今後の情報分野での学習に大いに役立つと思う。

これまではコンピュータなどの電子機器の内部がどのようになっているのか、
想像もつかなかったが、
この一年間を通して、電子回路を一から組み上げてきたことで、
コンピュータを分解していくとどのような構成にたどり着くのか、
考えることができるようになった。
将来コンピュータと深く関わっていく上で、
このような知識を持っているということは重要であると思う。



\section{課題60}

\subsection{課題内容}

その他、実験を行なって気がついたこと。

\subsection{解答}

今までバラバラに学んでいた専門科目の授業内容が、
この実験内容に深く関わっていることに気づいた。
これにより、今学んでいる内容は、
すべてコンピュータの構成に関わってくるものだ、
ということを実感することができた。

\section{課題61}

\subsection{課題内容}

教員あるいはTAによる動作確認検査を行った日時と時間。

\subsection{解答}

2013年1月24日 16:16


\section{課題62}

\subsection{課題内容}

自由な発想でなにか作れ。作成したシステムにかっこいい名前をつけよ。

\subsection{解答}




\section{課題63}

\subsection{課題内容}

作成したシステムの全体概要、実行結果を説明せよ。
PowerPointなどでスライド一枚にまとめること。

\subsection{解答}



\section{課題62}

\subsection{課題内容}

システムの良さを可能な限りアピールせよ。
作成したシステムの改善点、不足している点などについても記述すること。

\subsection{解答}

% http://ja.wikipedia.org/wiki/チャタリング
% https://secure-resource.renesas.com/edu/demo/dig/s06/FO01.htm
% チャタリング防止回路

% http://ja.wikipedia.org/wiki/オープンコレクタ
\end{document}