ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®å‹•ä½œä¸­ã€
é›»æºã‚’ã„ããªã‚Šè½ã¨ã™ã¨ãªãœã¾ãšã„ã®ã‹ã€‚
NIXã¨WINDOWSã®é•ã„ãŒã‚ã‚‹ã®ã¯ãªãœã‹ã€‚

ãƒ©ã‚¤ãƒˆãƒãƒƒã‚¯
ãƒ©ã‚¤ãƒˆã‚¹ãƒ«ãƒ¼

## ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å±•é–‹ã—ãŸå¾Œã®æ–‡å­—æ•°ã‚’è¿”ã™ã€‚
## æ—¥æœ¬èªæœªå¯¾å¿œã€‚
countPChars(){
    print -n -P -- "$1" | sed -e $'s/\e\[[0-9;]*m//g' | wc -m | sed -e 's/ //g'
}

update_prompt() {

    local bRestLength=$[COLUMNS - 14]

    local bRight="$pbRight"
    local bLeftWithoutPath="${pbLeft:s/%~//}"
    local bLeftWithoutPathLength=$(countPChars "$bLeftWithoutPath")

    local maxPathLength=$[bRestLength - bLeftWithoutPathLength]
    bLeft=${pbLeft:s/%~/%(C,%${maxPathLength}<...<%~%<<,)/}

    local bLeftLength=$(countPChars "$bLeft")
    bRestLength=$[bRestLength - bLeftLength]
    local separator="${(l:${bRestLength}:: :)}"
    bLeft="${bLeft}${separator}"

    PROMPT="${bLeft}${bRight}"$'\n'" $pMark "

    psvar=()
    LANG=en_US.UTF-8 vcs_info
    [[ -n "$vcs_info_msg_0_" ]] && psvar[1]="$vcs_info_msg_0_"

    # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚Œã°è¡¨ç¤ºï¼Œãã†ã§ãªã‘ã‚Œã°éè¡¨ç¤º
    RPROMPT="%1(v|%F{green}%1v%f|)"

    SPROMPT="%{[31m%}%r is correct? [n,y,a,e]:%{[m%} "
}

## ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå‰ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ãƒ•ãƒƒã‚¯ã€‚
precmd_functions=($precmd_functions update_prompt)
